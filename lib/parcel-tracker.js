parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"oB20":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("@hapi/joi"));function r(e){return e&&e.__esModule?e:{default:e}}const a=e.default.extend(e=>({type:"regex",base:e.any(),messages:{"regex.base":'"{{#label}}" must be an instance of RegExp'},validate(e,r){if(!(e instanceof RegExp))return{value:e,errors:r.error("regex.base")}}})),t={id:a.string().pattern(/^[A-Z_]+$/).required().label("Courier identifier"),name:a.string().required().label("Courier name"),matchers:a.array().items(a.regex().required().label("Courier matcher value")).single().required().label("Courier matchers"),number:a.string().required().label("Tracking number")};var i=t;exports.default=i;
},{}],"kXKp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("@hapi/joi")),t=r(require("debug")),a=r(require("./validation"));function r(e){return e&&e.__esModule?e:{default:e}}class u{constructor(t,r,u){return this.id=e.default.attempt(t,a.default.id),this.name=e.default.attempt(r,a.default.name),this.matchers=e.default.attempt(u,a.default.matchers),this}track(r,u=(0,t.default)(`parcel-tracker:${this.id.toLowerCase()}`)){this.log=u,this.log("validate tracking number"),e.default.assert(r,a.default.number)}}exports.default=u;
},{"./validation":"oB20"}],"uObA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("@hapi/joi"));function t(e){return e&&e.__esModule?e:{default:e}}const a=e.default.object().keys({status:e.default.string().required().label("Step status"),location:e.default.string().allow(null).required().label("Step location"),datetime:e.default.date().timestamp("javascript").required().label("Step datetime")}).label("Parcel step"),l={lang:e.default.string().default("fr_FR").label("Parcel language"),number:e.default.string().required().label("Parcel number"),courier:e.default.string().required().label("Parcel courier"),step:a,steps:e.default.array().items(a).required().label("Parcel steps")};var r=l;exports.default=r;
},{}],"MjDz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=a(require("@hapi/joi")),t=a(require("./validation"));function a(e){return e&&e.__esModule?e:{default:e}}const r=(a,r)=>{const u=e.default.attempt(a,e.default.object().keys({lang:t.default.lang,id:t.default.number,courier:t.default.courier,steps:t.default.steps}));return{lang:u.lang,scope:"public",returnCode:200,shipment:{idShip:u.id,product:u.courier,isFinal:!1,event:u.steps.map((e,t)=>({order:u.steps.length-t,date:e.datetime,location:e.location,label:e.status}))}}};var u=r;exports.default=u;
},{"./validation":"uObA"}],"Sikj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var r={notFound:Error("notFound"),noData:Error("noData"),zipCode:Error("zipCode"),unknown:function(r,o){return"production"!==process.env.NODE_ENV?(o(`UNKNOWN ERROR\n\n${r}`),Error(r.message)):Error("unknown")},internal:function(r){return"production"!==process.env.NODE_ENV?(this.log(`${this.id}: INTERNAL ERROR\n\n${r}`),Error(r.message)):Error("internal")}};exports.default=r;
},{}],"wTli":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("lodash.get")),t=o(require("moment-timezone"));function o(e){return e&&e.__esModule?e:{default:e}}const l=function(o,l){l("formatting data");const r=[];for(const u of o){const o=(0,e.default)(u,"Libelle[0]"),l=(0,e.default)(u,"Code_Etat[0]").trim();if(o&&"IM"!==l&&"SM"!==l){let o=null;if("CFR"!==(0,e.default)(u,"Numero_Poste_Comptable[0]")){const t=(0,e.default)(u,"CP[0]");if(t&&t.trim())o=(0,e.default)(u,"Bureau[0]",null);else if(u.Information_Complementaire){const t=u.Information_Complementaire.filter(e=>"Lieu"===e.$.nom);o=(0,e.default)(t,"[0]._",null)}}r.push({datetime:+t.default.tz(`${u.Date[0]} ${u.Heure[0]}`,"dddd DD/MM/YYYY HH:mm","fr","Europe/Paris"),status:u.Libelle[0],location:o})}}return r};var r=l;exports.default=r;
},{}],"MbVj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var r=a(require("lodash.get")),e=require("util"),t=require("xml2js"),o=a(require("../../utils/errors"));function a(r){return r&&r.__esModule?r:{default:r}}const u=(0,e.promisify)(t.parseString),n=async function(e,t){if(t("scraping data"),!e)throw t("no data to scrape"),o.default.noData;t("transforming xml data for processing");const a=await u(e);if(t("searching for courier error"),"MSG_AUCUN_NUMERO_LT"===(0,r.default)(a,"Rapport.Erreur[0].Code[0]"))throw t("courrier error: MSG_AUCUN_NUMERO_LT"),o.default.notFound;if("MSG_AUCUN_EVT"===(0,r.default)(a,"Reponse.Objet[0].Code_Erreur[0]"))throw t("courrier error: MSG_AUCUN_EVT"),o.default.notFound;return t("no error found, returning parcel data"),(0,r.default)(a,"Reponse.Objet[0].Evenement")};var i=n;exports.default=i;
},{"../../utils/errors":"Sikj"}],"Wp6c":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=o(require("axios")),e=o(require("../../utils/Courier")),r=o(require("../../utils/Parcel")),i=o(require("../../utils/errors")),s=o(require("./formatter")),a=o(require("./scraper"));function o(t){return t&&t.__esModule?t:{default:t}}const l=t=>({method:"get",url:`http://quickservices.chronopost.fr/servletSuiviXML?langue=fr_FR&privacy=W&infosPlus=true&listeNumerosLT=${t}`});class u extends e.default{async track(e,o){super.track(e,o),this.log("performing http call to retrieve tracking data");const u=await(0,t.default)(l(e)).catch(t=>{throw this.log("failed to retrieve tracking data"),this.log(t),i.default.internal.call(this,t)});this.log("data retrieved");const d=await(0,a.default)(u.data,this.log),c=(0,r.default)({id:e,courier:this.id,steps:(0,s.default)(d,this.log)});return this.log("tracking result"),this.log(c),c}}const d=new u("CHRONOPOST","Chronopost",[/\b(\w{2}\d{9}\w{2})\b/i,/\b(\w{2}\d{13})\b/i,/\b(\d{14}\w)\b/i]);var c=d;exports.default=c;
},{"../../utils/Courier":"kXKp","../../utils/Parcel":"MjDz","../../utils/errors":"Sikj","./formatter":"wTli","./scraper":"MbVj"}],"FRES":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=r(require("cheerio")),e=r(require("moment-timezone"));function r(t){return t&&t.__esModule?t:{default:t}}const o=function(r,o){o("formatting data");const u=[];return r.each((r,o)=>{const i=(0,t.default)(o);u.push({datetime:+e.default.tz(i.children("td:first-child").text(),"DD/MM/YYYY","fr","Europe/Paris"),location:null,status:i.children("td:last-child").text()})}),u};var u=o;exports.default=u;
},{}],"v6BY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("cheerio")),t=r(require("../../utils/errors"));function r(e){return e&&e.__esModule?e:{default:e}}const a=function(r,a){if(a("scraping data"),!r)throw a("no data to scrape"),t.default.noData;a("parsing html data for processing");const o=e.default.load(r,{ignoreWhitespace:!0});if(a("searching for parcel data"),0===o(".tableHistoriqueColis").length)throw a("no parcel data found"),t.default.notFound;return a("returning parcel data"),o(".tableHistoriqueColis tr.bandeauText")};var o=a;exports.default=o;
},{"../../utils/errors":"Sikj"}],"xIZV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=l(require("axios")),e=l(require("../../utils/Courier")),r=l(require("../../utils/Parcel")),i=l(require("../../utils/errors")),s=l(require("./formatter")),o=l(require("./scraper"));function l(t){return t&&t.__esModule?t:{default:t}}const a=(t,e)=>({method:"get",url:`https://www.colisprive.com/moncolis/pages/detailColis.aspx?numColis=${t}${e}`});class u extends e.default{async track(e,l){super.track(e,l),this.log("testing for zip code presence");const[u,d]=e.split(":");if(!d)throw this.log("zip code missing"),i.default.zipCode;this.log("performing http call to retrieve tracking data");const c=await(0,t.default)(a(u,d)).catch(t=>{throw this.log("failed to retrieve tracking data"),this.log(t),i.default.internal.call(this,t)});this.log("data retrieved");const n=(0,r.default)({id:e,courier:this.id,steps:(0,s.default)((0,o.default)(c.data,this.log),this.log)});return this.log("tracking result"),this.log(n),n}}const d=new u("COLIS_PRIVE","Colis Priv√©",[/\b(\d{17})\b/i,/\b(\d{12})\b/i]);var c=d;exports.default=c;
},{"../../utils/Courier":"kXKp","../../utils/Parcel":"MjDz","../../utils/errors":"Sikj","./formatter":"FRES","./scraper":"v6BY"}],"RLAl":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("moment-timezone"));function t(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function n(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){o(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const c={"Arriv√©e √† l'agence DHL de ":"Arriv√©e √† l'agence DHL","Arriv√©e au centre de tri DHL de ":"Arriv√©e au centre de tri DHL","D√©douanement accompli √† ":"D√©douanement accompli","En cours de d√©douanement √† ":"En cours de d√©douanement","Transf√©r√© via ":"Transf√©r√©","Partie de l'agence DHL de ":"Partie de l'agence DHL","Trait√©e √† l'agence DHL de ":"Trait√©e √† l'agence DHL"},i=function(t,r){r("formatting data");let o,i=[];t.checkpoints?(i=t.checkpoints,o="dddd, MMMM DD, YYYY HH:mm"):t.events&&(i=t.events,o="YYYY-MM-DD HH:mm:ss");const a=[];for(const s of i){const t=Object.keys(c).reduce((e,t,r)=>{if(-1!==e.status.indexOf(t)){const r=e.status.match(new RegExp(`^${t}(.*)$`));r&&(e=r.reduce((r,n,o)=>(0===o?r.status=c[t]:e.location||1!==o||"string"!=typeof n||(r.location=n.replace(/[.]/g,"").trim()),r),{status:e.status,location:e.location}))}return e},{status:s.description.trim(),location:s.location&&s.location.trim()||null});a.push(n({datetime:+e.default.tz(`${s.date.trim()} ${s.time.trim()}`,o,"fr","Europe/Paris")},t))}return a};var a=i;exports.default=a;
},{}],"hbg6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var r=t(require("lodash.get")),e=t(require("../../utils/errors"));function t(r){return r&&r.__esModule?r:{default:r}}const o=function(t,o){if(o("scraping data"),!t)throw o("no data to scrape"),e.default.noData;o("searching for courier error");const a=(0,r.default)(t,"meta.error")||t.errors;if(a)throw o("courrier error:"),o(a),e.default.notFound;let n=(0,r.default)(t,"results[0]");if(n&&n.checkpoints)return o("no error found, returning parcel data"),n;if(o("no error found, searching for parcel data"),(n=(0,r.default)(t,"data.mailItems[0]"))&&n.events)return o("returning parcel data"),n;throw o("no parcel data found"),e.default.notFound};var a=o;exports.default=a;
},{"../../utils/errors":"Sikj"}],"lH0s":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("axios")),t=o(require("../../utils/Courier")),r=o(require("../../utils/Parcel")),s=o(require("../../utils/errors")),a=o(require("./formatter")),i=o(require("./scraper"));function o(e){return e&&e.__esModule?e:{default:e}}const l=e=>[{method:"get",url:`https://www.logistics.dhl/shipmentTracking?countryCode=FR&languageCode=fr&AWB=${e}`,headers:{Accept:"application/json","User-Agent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36","Accept-Language":"fr-FR"},responseType:"json"},{method:"get",url:`https://www.logistics.dhl/v1/mailitems/track?number=${e}`,headers:{Accept:"application/json","User-Agent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36","Accept-Language":"fr-FR"},responseType:"json"}];class n extends t.default{async track(t,o){let n,u;super.track(t,o),this.log("performing multiple http calls...");for(const r of l(t))try{this.log("performing http call to retrieve tracking data");const t=await(0,e.default)(r);n=(0,a.default)((0,i.default)(t.data,this.log),this.log),this.log("data retrieved");break}catch(d){u=d}if(u&&!n){if(this.log("failed to retrieve tracking data"),this.log(u),u.response&&(400===u.response.status||503===u.response.status))throw s.default.notFound;if("notFound"!==u.message&&"noData"!==u.message)throw s.default.internal.call(this,u);throw u}const c=(0,r.default)({id:t,courier:this.id,steps:n});return this.log("tracking result"),this.log(c),c}}const u=new n("DHL","DHL",[/\b(\d{10})\b/i,/\b(\w{4}\d{20})\b/i]);var c=u;exports.default=c;
},{"../../utils/Courier":"kXKp","../../utils/Parcel":"MjDz","../../utils/errors":"Sikj","./formatter":"RLAl","./scraper":"hbg6"}],"wrUh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=a(require("cheerio")),t=a(require("moment-timezone"));function a(e){return e&&e.__esModule?e:{default:e}}const r=function(a,r){r("formatting data");const n=[];if(a.scan){let e=a.scan.length-1;a.scan.forEach(a=>{n[e]={location:a.scanData.location,status:a.scanDescription.content[0],datetime:+t.default.tz(a.date,"YYYY-MM-DDTHH:mm:ssZ","fr","Europe/Paris")},e--})}else a.each((a,r)=>{const i=(0,e.default)(r),c=i.children("td[id^=dateTableTrace]").text(),d=i.children("td[id^=heureTableTrace]").text(),l=i.children("td[id^=lieuTableTrace]").text().match(/(Agence DPD de|Centre de tri DPD de) (.*) \(.*\)/i),s=i.children("td[id^=statutTableTrace]").text().replace(/\s+/g," ").trim();let o=null;l&&(o=l[2]||null),n.push({datetime:+t.default.tz(`${c} ${d}`,"DD/MM/YYYY HH:mm","fr","Europe/Paris"),location:o,status:s})});return n};var n=r;exports.default=n;
},{}],"laLF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("cheerio")),a=t(require("lodash.get")),r=t(require("../../utils/errors"));function t(e){return e&&e.__esModule?e:{default:e}}const n=function(t,n){if(n("scraping data"),!t)throw n("no data to scrape"),r.default.noData;if("string"==typeof t){n("parsing html data for processing");const a=e.default.load(t,{ignoreWhitespace:!0});if(n("searching for parcel data"),0===a("table#tableTrace tr[id^=ligneTableTrace]").length)throw n("no parcel data found"),r.default.notFound;return n("returning parcel data"),a("table#tableTrace tr[id^=ligneTableTrace]")}{n("searching for parcel data");const e=(0,a.default)(t,"parcellifecycleResponse.parcelLifeCycleData.scanInfo");if(e)return n("returning parcel data"),e;n("no parcel data found")}throw r.default.notFound};var o=n;exports.default=o;
},{"../../utils/errors":"Sikj"}],"HQxv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("axios")),t=o(require("../../utils/Courier")),r=o(require("../../utils/Parcel")),s=o(require("../../utils/errors")),a=o(require("./formatter")),i=o(require("./scraper"));function o(e){return e&&e.__esModule?e:{default:e}}const l=e=>[{method:"get",url:`https://tracking.dpd.de/rest/plc/fr_FR/${e}`,responseType:"json"},{method:"get",url:`http://www.dpd.fr/trace/${e}`,headers:{"User-Agent":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36"},responseType:"text"}];class u extends t.default{async track(t,o){let u,d;super.track(t,o),this.log("performing multiple http calls...");for(const r of l(t))try{this.log("performing http call to retrieve tracking data");const t=await(0,e.default)(r);u=(0,a.default)((0,i.default)(t.data,this.log),this.log),this.log("data retrieved");break}catch(c){d=c}if(d&&!u){if(this.log("failed to retrieve tracking data"),this.log(d),"notFound"!==d.message&&"noData"!==d.message)throw s.default.internal.call(this,d);throw d}const n=(0,r.default)({id:t,courier:this.id,steps:u});return this.log("tracking result"),this.log(n),n}}const d=new u("DPD","DPD",[/\b(\d{14,16})\b/i]);var n=d;exports.default=n;
},{"../../utils/Courier":"kXKp","../../utils/Parcel":"MjDz","../../utils/errors":"Sikj","./formatter":"wrUh","./scraper":"laLF"}],"yQSX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e(require("moment-timezone"));function e(t){return t&&t.__esModule?t:{default:t}}const o=function(e,o){o("formatting data");const r=[];for(const s of e)r.push({status:s.status,location:s.scanLocation||null,datetime:+t.default.tz(`${s.date} ${s.time}`,"YYYY-MM-DD HH:mm:ss","fr","Europe/Paris")});return r};var r=o;exports.default=r;
},{}],"pGa9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var r=t(require("lodash.get")),e=t(require("../../utils/errors"));function t(r){return r&&r.__esModule?r:{default:r}}const a=function(t,a){if(a("scraping data"),!t)throw a("no data to scrape"),e.default.noData;const o=(0,r.default)(t,"TrackPackagesResponse.packageList[0]");if(a("searching for courier error"),o&&o.isInvalid)throw a("courrier error: pkg is invalid"),e.default.notFound;const n=(0,r.default)(o,"errorList[0].message");if(n)throw a("courrier error:"),a(n),e.default.unknown(n,a);if(a("searching for parcel data"),o&&o.scanEventList)return a("returning parcel data"),o.scanEventList;throw a("no parcel data found"),e.default.notFound};var o=a;exports.default=o;
},{"../../utils/errors":"Sikj"}],"eiWt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("axios")),t=o(require("../../utils/Courier")),r=o(require("../../utils/Parcel")),a=o(require("../../utils/errors")),i=o(require("./formatter")),s=o(require("./scraper"));function o(e){return e&&e.__esModule?e:{default:e}}const n=e=>{const t=new URLSearchParams;return t.append("data",`{"TrackPackagesRequest":{"appType":"WTRK","appDeviceType":"DESKTOP","uniqueKey":"","processingParameters":{},"trackingInfoList":[{"trackNumberInfo":{"trackingNumber":"${e}","trackingQualifier":"","trackingCarrier":""}}]}}`),t.append("action","trackpackages"),t.append("locale","fr_FR"),t.append("version","1"),t.append("format","json"),{method:"post",url:"https://www.fedex.com/trackingCal/track",data:t.toString(),responseType:"json"}};class c extends t.default{async track(t,o){super.track(t,o),this.log("performing http call to retrieve tracking data");const c=await(0,e.default)(n(t)).catch(e=>{throw this.log("failed to retrieve tracking data"),this.log(e),a.default.internal.call(this,e)});this.log("data retrieved");const l=(0,r.default)({id:t,courier:this.id,steps:(0,i.default)((0,s.default)(c.data,this.log),this.log)});return this.log("tracking result"),this.log(l),l}}const l=new c("FEDEX","FedEx",[/\b(\d{10})\b/i,/\b(\d{12})\b/i,/\b(\d{15})\b/i,/\b(\d{22})\b/i]);var u=l;exports.default=u;
},{"../../utils/Courier":"kXKp","../../utils/Parcel":"MjDz","../../utils/errors":"Sikj","./formatter":"yQSX","./scraper":"pGa9"}],"W2Fj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("moment-timezone"));function t(e){return e&&e.__esModule?e:{default:e}}const r=function(t,r){r("formatting data");const s=[];for(const a of t){let t=null;a.address&&a.address.countryName&&(t=a.address.city?`${a.address.city}, ${a.address.countryName}`:`${a.address.countryName}`),s.push({location:t,status:a.evtDscr,datetime:+e.default.tz(`${a.date} ${a.time}`,"YYYY-MM-DD HH:mm:ss","fr","Europe/Paris")})}return s};var s=r;exports.default=s;
},{}],"kt7C":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=r(require("lodash.get")),e=r(require("../../utils/errors"));function r(t){return t&&t.__esModule?t:{default:t}}const a=function(r,a){if(a("scraping data"),!r)throw a("no data to scrape"),e.default.noData;a("searching for parcel data");const o=(0,t.default)(r,"tuStatus[0].history");if(o&&o.length)return a("returning parcel data"),o;throw a("no parcel data found"),e.default.notFound};var o=a;exports.default=o;
},{"../../utils/errors":"Sikj"}],"JQAK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("axios")),t=o(require("../../utils/Courier")),r=o(require("../../utils/Parcel")),s=o(require("../../utils/errors")),i=o(require("./formatter")),a=o(require("./scraper"));function o(e){return e&&e.__esModule?e:{default:e}}const l=e=>({method:"get",url:`https://gls-group.eu/app/service/open/rest/FR/fr/rstt001?match=${e}`,responseType:"json"});class u extends t.default{async track(t,o){super.track(t,o),this.log("performing http call to retrieve tracking data");const u=await(0,e.default)(l(t)).catch(e=>{if(this.log("failed to retrieve tracking data"),this.log(e),e.response&&404===e.response.status&&e.response.data)throw s.default.notFound;throw s.default.internal.call(this,e)});this.log("data retrieved");const d=(0,r.default)({id:t,courier:this.id,steps:(0,i.default)((0,a.default)(u.data,this.log),this.log)});return this.log("tracking result"),this.log(d),d}}const d=new u("GLS","GLS",[/\b(\w{7}[A-Z])\b/i,/\b(\d{14,15})\b/i,/\b(\d{10,12})\b/i,/\b(\d{20})\b/i,/\b(\w{2}\d{9}\w{2})\b/i]);var n=d;exports.default=n;
},{"../../utils/Courier":"kXKp","../../utils/Parcel":"MjDz","../../utils/errors":"Sikj","./formatter":"W2Fj","./scraper":"kt7C"}],"QI67":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e(require("moment-timezone"));function e(t){return t&&t.__esModule?t:{default:t}}const o=function(e,o){o("formatting data");const r=[];for(const u of e)r.push({status:u.label,location:null,datetime:+t.default.tz(u.date,null,"fr","Europe/Paris")});return r};var r=o;exports.default=r;
},{}],"KpiE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("lodash.get")),t=r(require("../../utils/errors"));function r(e){return e&&e.__esModule?e:{default:e}}const o=function(r,o){if(o("scraping data"),!r)throw o("no data to scrape"),t.default.noData;if(200!==r.returnCode)throw o("courier error: returnCode not 200"),t.default.notFound;if(o("searching for parcel data"),(0,e.default)(r,"shipment.event.length"))return o("returning parcel data"),r.shipment.event;throw o("no parcel data found"),t.default.notFound};var a=o;exports.default=a;
},{"../../utils/errors":"Sikj"}],"C0Mh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=n(require("axios")),e=n(require("../../utils/Courier")),r=n(require("../../utils/Parcel")),s=n(require("../../utils/errors")),a=n(require("../chronopost")),i=n(require("./formatter")),o=n(require("./scraper")),l=n(require("lodash.get"));function n(t){return t&&t.__esModule?t:{default:t}}const u=async e=>{const r=await(0,t.default)({method:"get",url:"https://www.laposte.fr/outils/suivre-vos-envois"}),[s]=r.headers["set-cookie"].map(t=>t.split(";")[0]);if(s)return{method:"get",url:`https://api.laposte.fr/ssu/v1/suivi-unifie/idship/${e}?lang=fr_FR`,headers:{Cookie:`${s};`,Accept:"application/json"},responseType:"json"};throw Error("Missing JWT access token")};class c extends e.default{async track(e,n){super.track(e,n),this.log("performing http call to get call parameters");const c=await u(e).catch(t=>{throw this.log("failed to retrieve call parameters"),this.log(t),s.default.internal.call(this,t)});this.log("performing http call to retrieve tracking data");const d=await(0,t.default)(c).catch(t=>{this.log("failed to retrieve tracking data"),this.log(t);const e=(0,l.default)(t,"response.status");if((404===e||400===e)&&t.response.data)throw s.default.notFound;throw s.default.internal.call(this,t)});if(d.data&&d.data.shipment&&"chronopost"===d.data.shipment.product)return this.log("parcel is owned by chronopost, performing a new tracking with this courier"),a.default.track(e);this.log("data retrieved");const h=(0,r.default)({id:e,courier:this.id,steps:(0,i.default)((0,o.default)(d.data,this.log),this.log)});return this.log("tracking result"),this.log(h),h}}const d=new c("LA_POSTE","La Poste",[/\b(\w{2}\d{9}\w{2})\b/i]);var h=d;exports.default=h;
},{"../../utils/Courier":"kXKp","../../utils/Parcel":"MjDz","../../utils/errors":"Sikj","../chronopost":"Wp6c","./formatter":"QI67","./scraper":"KpiE"}],"vQrI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("cheerio")),t=r(require("moment-timezone"));function r(e){return e&&e.__esModule?e:{default:e}}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){c(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const i={"Prise en charge en agence ":"Prise en charge en agence"},s=function(r,n){n("formatting data");const c=[];return r.each((r,n)=>{const s=(0,e.default)(n),a=s.parents(".infos-account").find(".infos-colis :nth-child(3) strong").text(),u=s.children("div:first-child").find("p").text();if(u.trim()){const e=Object.keys(i).reduce((e,t)=>{if(!e.location&&-1!==e.status.indexOf(t)){const r=e.status.match(new RegExp(`^${t}(.*)$`));r&&(e=r.reduce((e,r,n)=>(0===n?e.status=i[t]:1===n&&"string"==typeof r&&(e.location=r.replace(/[.]/g,"").trim()),e),{status:e.status,location:e.location}))}return e},{status:s.children("div:nth-child(2)").find("p").text(),location:null});c.push(o({},e,{datetime:+t.default.tz(`${a} ${u}`,"DD/MM/YYYY HH:mm","fr","Europe/Paris")}))}}),c};var a=s;exports.default=a;
},{}],"NkJt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("cheerio")),t=o(require("../../utils/errors"));function o(e){return e&&e.__esModule?e:{default:e}}const a=function(o,a){if(a("scraping data"),!o)throw a("no data to scrape"),t.default.noData;a("parsing html data for processing");const r=e.default.load(o,{ignoreWhitespace:!0});if(a("searching for parcel data"),0===r("#suivie_mon_colis .infos-account").length)throw a("no parcel data found"),t.default.notFound;return a("returning parcel data"),r("#suivie_mon_colis .infos-account .detail-infos > .step-suivi")};var r=a;exports.default=r;
},{"../../utils/errors":"Sikj"}],"lR1W":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=a(require("axios")),t=a(require("../../utils/Courier")),r=a(require("../../utils/Parcel")),i=a(require("../../utils/errors")),s=a(require("./formatter")),o=a(require("./scraper"));function a(e){return e&&e.__esModule?e:{default:e}}const l=(e,t)=>{let r;return{method:"get",url:r=t?`http://www.mondialrelay.fr/suivi-de-colis?codePostal=${t}&numeroExpedition=${e}`:`http://www.mondialrelay.fr/suivi-de-colis?numeroExpedition=${e}`,responseType:"text"}};class d extends t.default{async track(t,a){super.track(t,a);const[d,u]=t.split(":");if(8===d.length&&(this.log("testing for zip code presence"),!u))throw this.log("zip code missing"),i.default.zipCode;this.log("performing http call to retrieve tracking data");const n=await(0,e.default)(l(d,u)).catch(e=>{if(this.log("failed to retrieve tracking data"),this.log(e),e.response&&404===e.response.status&&e.response.data)throw i.default.notFound;throw i.default.internal.call(this,e)}),c=(0,r.default)({id:t,courier:this.id,steps:(0,s.default)((0,o.default)(n.data,this.log),this.log)});return this.log("tracking result"),this.log(c),c}}const u=new d("MONDIAL_RELAY","Mondial Relay",[/\b(\w{7}[A-Z])\b/i,/\b(\d{14,15})\b/i,/\b(\d{10,12})\b/i,/\b(\d{20})\b/i,/\b(\w{2}\d{9}\w{2})\b/i]);var n=u;exports.default=n;
},{"../../utils/Courier":"kXKp","../../utils/Parcel":"MjDz","../../utils/errors":"Sikj","./formatter":"vQrI","./scraper":"NkJt"}],"mYUU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=r(require("cheerio")),e=r(require("moment-timezone"));function r(t){return t&&t.__esModule?t:{default:t}}const i=function(r,i){i("formatting data");const s=[];if(r.events)for(const t of r.events)s.push({location:t.location.city||null,datetime:+e.default.tz(t.date,null,"fr","Europe/Paris"),status:t.statusDescription});else r.each((r,i)=>{const o=(0,t.default)(i),l=o.children(".roster__item:nth-child(2)").text().replace(/\s+/g," ").trim(),a=o.children(".roster__item:last-child").text().replace(/\s+/g," ").trim(),n=o.children(".roster__item:first-child").text().replace(/\s+/g," ").trim();s.push({datetime:+e.default.tz(l,"DD/MM/YYYY HH:mm","fr","Europe/Paris"),location:a||null,status:n})});return s};var s=i;exports.default=s;
},{}],"Wu3r":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("cheerio")),t=r(require("../../utils/errors"));function r(e){return e&&e.__esModule?e:{default:e}}const n=function(r,n){if(n("scraping data"),!r)throw n("no data to scrape"),t.default.noData;n("parsing html data for processing");const a=e.default.load(r,{ignoreWhitespace:!0});if(n("searching for parcel data"),a(".result__content .roster").length>0)return n("returning parcel data"),a(".result__content .roster[class*=tnt]");{const e=r["tracker.output"],t=e&&e.consignment;if(t&&t.length&&(t.sort((e,t)=>+new Date(t.originDate)-+new Date(e.originDate)),t[0].events&&t[0].events.length))return n("returning parcel data"),e.consignment[0]}throw n("no parcel data found"),t.default.notFound};var a=n;exports.default=a;
},{"../../utils/errors":"Sikj"}],"J2Yw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=a(require("axios")),t=a(require("../../utils/Courier")),r=a(require("../../utils/Parcel")),i=a(require("../../utils/errors")),o=a(require("./formatter")),s=a(require("./scraper"));function a(e){return e&&e.__esModule?e:{default:e}}const l=e=>[{method:"get",url:`https://www.tnt.com/api/v3/shipment?searchType=CON&locale=fr_FR&con=${e}`,responseType:"json"},{method:"get",url:`https://www.tnt.fr/public/suivi_colis/recherche/visubontransport.do?radiochoixrecherche=BT&radiochoixtypeexpedition=NAT&bonTransport=${e}`,responseType:"text"}];class u extends t.default{async track(t,a){let u,c;super.track(t,a),this.log("performing multiple http calls...");for(const r of l(t))try{this.log("performing http call to retrieve tracking data");const t=await(0,e.default)(r);u=(0,o.default)((0,s.default)(t.data,this.log),this.log),this.log("data retrieved");break}catch(d){c=d}if(c&&!u){if(this.log("failed to retrieve tracking data"),this.log(c),"notFound"!==c.message&&"noData"!==c.message)throw i.default.internal.call(this,c);throw c}const n=(0,r.default)({id:t,courier:this.id,steps:u});return this.log("tracking result"),this.log(n),n}}const c=new u("TNT","TNT",[/\b(\d{9})\b/i,/\b(\d{16})\b/i]);var n=c;exports.default=n;
},{"../../utils/Courier":"kXKp","../../utils/Parcel":"MjDz","../../utils/errors":"Sikj","./formatter":"mYUU","./scraper":"Wu3r"}],"zhuh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=o(require("he")),e=o(require("moment-timezone"));function o(t){return t&&t.__esModule?t:{default:t}}const a=function(o,a){a("formatting data");const r=[];for(const i of o)i.activityScan&&r.push({datetime:+e.default.tz(`${i.date} ${i.time}`,"DD/MM/YYYY HH:mm","fr","Europe/Paris"),location:i.location,status:t.default.decode(i.activityScan)});return r};var r=a;exports.default=r;
},{}],"hu7Y":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("lodash.get")),t=r(require("../../utils/errors"));function r(e){return e&&e.__esModule?e:{default:e}}const a=function(r,a){if(a("scraping data"),!r)throw a("no data to scrape"),t.default.noData;a("searching for parcel data");const o=(0,e.default)(r,"trackDetails[0].shipmentProgressActivities");if(o)return a("returning parcel data"),o;throw a("no parcel data found"),t.default.notFound};var o=a;exports.default=o;
},{"../../utils/errors":"Sikj"}],"IHxW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=o(require("axios")),e=o(require("../../utils/Courier")),r=o(require("../../utils/Parcel")),a=o(require("../../utils/errors")),i=o(require("./formatter")),s=o(require("./scraper"));function o(t){return t&&t.__esModule?t:{default:t}}const l=t=>({method:"post",url:"https://www.ups.com/track/api/Track/GetStatus?loc=fr_FR",headers:{"Content-Type":"application/json"},data:{Locale:"fr_FR",TrackingNumber:[t]},responseType:"json"});class u extends e.default{async track(e,o){super.track(e,o),this.log("performing http call to retrieve tracking data");const u=await(0,t.default)(l(e)).catch(t=>{throw this.log("failed to retrieve tracking data"),this.log(t),a.default.internal.call(this,t)}),c=(0,r.default)({id:e,courier:this.id,steps:(0,i.default)((0,s.default)(u.data,this.log),this.log)});return this.log("tracking result"),this.log(c),c}}const c=new u("UPS","UPS",[/\b(\w\d{10})\b/i,/\b(\d{26})\b/i,/\b(\d{18})\b/i,/\b(\d{9})\b/i,/\b(1Z\w{16})\b/i]);var d=c;exports.default=d;
},{"../../utils/Courier":"kXKp","../../utils/Parcel":"MjDz","../../utils/errors":"Sikj","./formatter":"zhuh","./scraper":"hu7Y"}],"bG8o":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"CHRONOPOST",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(exports,"COLIS_PRIVE",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(exports,"DHL",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(exports,"DPD",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(exports,"FEDEX",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(exports,"GLS",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(exports,"LA_POSTE",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(exports,"MONDIAL_RELAY",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(exports,"TNT",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(exports,"UPS",{enumerable:!0,get:function(){return d.default}});var e=p(require("./chronopost")),r=p(require("./colis_prive")),t=p(require("./dhl")),u=p(require("./dpd")),n=p(require("./fedex")),o=p(require("./gls")),i=p(require("./la_poste")),f=p(require("./mondial_relay")),l=p(require("./tnt")),d=p(require("./ups"));function p(e){return e&&e.__esModule?e:{default:e}}
},{"./chronopost":"Wp6c","./colis_prive":"xIZV","./dhl":"lH0s","./dpd":"HQxv","./fedex":"eiWt","./gls":"JQAK","./la_poste":"C0Mh","./mondial_relay":"lR1W","./tnt":"J2Yw","./ups":"IHxW"}],"P1L7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=o(require("debug")),t=n(require("./couriers"));function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}function n(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var i=o?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(n,a,i):n[a]=e[a]}return n.default=e,t&&t.set(e,n),n}function o(e){return e&&e.__esModule?e:{default:e}}const a={};for(const c of Object.keys(t)){const e=t[c];a[e.id]=e.matchers}const i=(t,r=(0,e.default)("parcel-tracker:identifier"))=>{r(`try to identify ${t}`);const n=new Set,o=new Set;for(const e of Object.keys(a)){r(`testing ${e}...`);for(const o of a[e])o.test(t)?(r(`${o} => MATCH`),n.add(e)):r(`${o} => NO MATCH`);n.has(e)?r(`${e} matches ${t} pattern, adding to candidates`):(r(`${e} doesn‚Äôt match ${t} pattern, adding to rest`),o.add(e))}const i={candidates:[...n],rest:[...o]};return r(`identification results of ${t} are`),r(i),i};var s=i;exports.default=s;
},{"./couriers":"bG8o"}],"Focm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"identify",{enumerable:!0,get:function(){return r.default}}),exports.couriers=void 0,require("moment/locale/fr");var e=o(require("./couriers"));exports.couriers=e;var r=t(require("./identifier"));function t(e){return e&&e.__esModule?e:{default:e}}function n(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return n=function(){return e},e}function o(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=n();if(r&&r.has(e))return r.get(e);var t={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(Object.prototype.hasOwnProperty.call(e,u)){var i=o?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(t,u,i):t[u]=e[u]}return t.default=e,r&&r.set(e,t),t}
},{"./couriers":"bG8o","./identifier":"P1L7"}]},{},["Focm"], null)